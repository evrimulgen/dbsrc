CREATE USER "SH" IDENTIFIED BY VALUES 'S:F18F6D409D3F02381F7E93078CBFD935C5C1464BB1B584E1B7283934894E;H:A85947F810559AF788007B767B903999;T:4863B55FF9BBBD80ECA5FBDF81E95F897487A78846500EFEC28D3D256057943BE8B5B6B9297BD0B898C42C276A815E49F7E7A034EE1D3809FAA2EA7751CC7F6537CAF9A1F1D5876299BF7BB702736E9A;9793B3777CD3BD1A'
      DEFAULT TABLESPACE "USERS"
      TEMPORARY TABLESPACE "TEMP"
      PASSWORD EXPIRE
      ACCOUNT LOCK;

GRANT CREATE DIMENSION TO "SH";
GRANT QUERY REWRITE TO "SH";
GRANT CREATE MATERIALIZED VIEW TO "SH";
GRANT CREATE DATABASE LINK TO "SH";
GRANT CREATE SEQUENCE TO "SH";
GRANT CREATE VIEW TO "SH";
GRANT CREATE SYNONYM TO "SH";
GRANT CREATE CLUSTER TO "SH";
GRANT CREATE TABLE TO "SH";
GRANT UNLIMITED TABLESPACE TO "SH";
GRANT ALTER SESSION TO "SH";
GRANT CREATE SESSION TO "SH";
GRANT "RESOURCE" TO "SH";
GRANT "SELECT_CATALOG_ROLE" TO "SH";
ALTER USER "SH" DEFAULT ROLE ALL;
CREATE TABLE "SH"."COSTS"
   (	"PROD_ID" NUMBER,
	"TIME_ID" DATE,
	"PROMO_ID" NUMBER,
	"CHANNEL_ID" NUMBER,
	"UNIT_COST" NUMBER(10,2),
	"UNIT_PRICE" NUMBER(10,2)
   ) ;

CREATE TABLE "SH"."SALES"
   (	"PROD_ID" NUMBER,
	"CUST_ID" NUMBER,
	"TIME_ID" DATE,
	"CHANNEL_ID" NUMBER,
	"PROMO_ID" NUMBER,
	"QUANTITY_SOLD" NUMBER(10,2),
	"AMOUNT_SOLD" NUMBER(10,2)
   ) ;

CREATE TABLE "SH"."DIMENSION_EXCEPTIONS"
   (	"STATEMENT_ID" VARCHAR2(30),
	"OWNER" VARCHAR2(30),
	"TABLE_NAME" VARCHAR2(30),
	"DIMENSION_NAME" VARCHAR2(30),
	"RELATIONSHIP" VARCHAR2(11),
	"BAD_ROWID" ROWID
   ) ;

CREATE TABLE "SH"."SUPPLEMENTARY_DEMOGRAPHICS"
   (	"CUST_ID" NUMBER,
	"EDUCATION" VARCHAR2(21),
	"OCCUPATION" VARCHAR2(21),
	"HOUSEHOLD_SIZE" VARCHAR2(21),
	"YRS_RESIDENCE" NUMBER,
	"AFFINITY_CARD" NUMBER(10,0),
	"BULK_PACK_DISKETTES" NUMBER(10,0),
	"FLAT_PANEL_MONITOR" NUMBER(10,0),
	"HOME_THEATER_PACKAGE" NUMBER(10,0),
	"BOOKKEEPING_APPLICATION" NUMBER(10,0),
	"PRINTER_SUPPLIES" NUMBER(10,0),
	"Y_BOX_GAMES" NUMBER(10,0),
	"OS_DOC_SET_KANJI" NUMBER(10,0),
	"COMMENTS" VARCHAR2(4000)
   ) ;

CREATE TABLE "SH"."COUNTRIES"
   (	"COUNTRY_ID" NUMBER,
	"COUNTRY_ISO_CODE" CHAR(2),
	"COUNTRY_NAME" VARCHAR2(40),
	"COUNTRY_SUBREGION" VARCHAR2(30),
	"COUNTRY_SUBREGION_ID" NUMBER,
	"COUNTRY_REGION" VARCHAR2(20),
	"COUNTRY_REGION_ID" NUMBER,
	"COUNTRY_TOTAL" VARCHAR2(11),
	"COUNTRY_TOTAL_ID" NUMBER,
	"COUNTRY_NAME_HIST" VARCHAR2(40)
   ) ;

CREATE TABLE "SH"."CUSTOMERS"
   (	"CUST_ID" NUMBER,
	"CUST_FIRST_NAME" VARCHAR2(20),
	"CUST_LAST_NAME" VARCHAR2(40),
	"CUST_GENDER" CHAR(1),
	"CUST_YEAR_OF_BIRTH" NUMBER(4,0),
	"CUST_MARITAL_STATUS" VARCHAR2(20),
	"CUST_STREET_ADDRESS" VARCHAR2(40),
	"CUST_POSTAL_CODE" VARCHAR2(10),
	"CUST_CITY" VARCHAR2(30),
	"CUST_CITY_ID" NUMBER,
	"CUST_STATE_PROVINCE" VARCHAR2(40),
	"CUST_STATE_PROVINCE_ID" NUMBER,
	"COUNTRY_ID" NUMBER,
	"CUST_MAIN_PHONE_NUMBER" VARCHAR2(25),
	"CUST_INCOME_LEVEL" VARCHAR2(30),
	"CUST_CREDIT_LIMIT" NUMBER,
	"CUST_EMAIL" VARCHAR2(50),
	"CUST_TOTAL" VARCHAR2(14),
	"CUST_TOTAL_ID" NUMBER,
	"CUST_SRC_ID" NUMBER,
	"CUST_EFF_FROM" DATE,
	"CUST_EFF_TO" DATE,
	"CUST_VALID" VARCHAR2(1)
   ) ;

CREATE TABLE "SH"."PROMOTIONS"
   (	"PROMO_ID" NUMBER(6,0),
	"PROMO_NAME" VARCHAR2(30),
	"PROMO_SUBCATEGORY" VARCHAR2(30),
	"PROMO_SUBCATEGORY_ID" NUMBER,
	"PROMO_CATEGORY" VARCHAR2(30),
	"PROMO_CATEGORY_ID" NUMBER,
	"PROMO_COST" NUMBER(10,2),
	"PROMO_BEGIN_DATE" DATE,
	"PROMO_END_DATE" DATE,
	"PROMO_TOTAL" VARCHAR2(15),
	"PROMO_TOTAL_ID" NUMBER
   ) ;

CREATE TABLE "SH"."CHANNELS"
   (	"CHANNEL_ID" NUMBER,
	"CHANNEL_DESC" VARCHAR2(20),
	"CHANNEL_CLASS" VARCHAR2(20),
	"CHANNEL_CLASS_ID" NUMBER,
	"CHANNEL_TOTAL" VARCHAR2(13),
	"CHANNEL_TOTAL_ID" NUMBER
   ) ;

CREATE TABLE "SH"."PRODUCTS"
   (	"PROD_ID" NUMBER(6,0),
	"PROD_NAME" VARCHAR2(50),
	"PROD_DESC" VARCHAR2(4000),
	"PROD_SUBCATEGORY" VARCHAR2(50),
	"PROD_SUBCATEGORY_ID" NUMBER,
	"PROD_SUBCATEGORY_DESC" VARCHAR2(2000),
	"PROD_CATEGORY" VARCHAR2(50),
	"PROD_CATEGORY_ID" NUMBER,
	"PROD_CATEGORY_DESC" VARCHAR2(2000),
	"PROD_WEIGHT_CLASS" NUMBER(3,0),
	"PROD_UNIT_OF_MEASURE" VARCHAR2(20),
	"PROD_PACK_SIZE" VARCHAR2(30),
	"SUPPLIER_ID" NUMBER(6,0),
	"PROD_STATUS" VARCHAR2(20),
	"PROD_LIST_PRICE" NUMBER(8,2),
	"PROD_MIN_PRICE" NUMBER(8,2),
	"PROD_TOTAL" VARCHAR2(13),
	"PROD_TOTAL_ID" NUMBER,
	"PROD_SRC_ID" NUMBER,
	"PROD_EFF_FROM" DATE,
	"PROD_EFF_TO" DATE,
	"PROD_VALID" VARCHAR2(1)
   ) ;

CREATE TABLE "SH"."TIMES"
   (	"TIME_ID" DATE,
	"DAY_NAME" VARCHAR2(9),
	"DAY_NUMBER_IN_WEEK" NUMBER(1,0),
	"DAY_NUMBER_IN_MONTH" NUMBER(2,0),
	"CALENDAR_WEEK_NUMBER" NUMBER(2,0),
	"FISCAL_WEEK_NUMBER" NUMBER(2,0),
	"WEEK_ENDING_DAY" DATE,
	"WEEK_ENDING_DAY_ID" NUMBER,
	"CALENDAR_MONTH_NUMBER" NUMBER(2,0),
	"FISCAL_MONTH_NUMBER" NUMBER(2,0),
	"CALENDAR_MONTH_DESC" VARCHAR2(8),
	"CALENDAR_MONTH_ID" NUMBER,
	"FISCAL_MONTH_DESC" VARCHAR2(8),
	"FISCAL_MONTH_ID" NUMBER,
	"DAYS_IN_CAL_MONTH" NUMBER,
	"DAYS_IN_FIS_MONTH" NUMBER,
	"END_OF_CAL_MONTH" DATE,
	"END_OF_FIS_MONTH" DATE,
	"CALENDAR_MONTH_NAME" VARCHAR2(9),
	"FISCAL_MONTH_NAME" VARCHAR2(9),
	"CALENDAR_QUARTER_DESC" CHAR(7),
	"CALENDAR_QUARTER_ID" NUMBER,
	"FISCAL_QUARTER_DESC" CHAR(7),
	"FISCAL_QUARTER_ID" NUMBER,
	"DAYS_IN_CAL_QUARTER" NUMBER,
	"DAYS_IN_FIS_QUARTER" NUMBER,
	"END_OF_CAL_QUARTER" DATE,
	"END_OF_FIS_QUARTER" DATE,
	"CALENDAR_QUARTER_NUMBER" NUMBER(1,0),
	"FISCAL_QUARTER_NUMBER" NUMBER(1,0),
	"CALENDAR_YEAR" NUMBER(4,0),
	"CALENDAR_YEAR_ID" NUMBER,
	"FISCAL_YEAR" NUMBER(4,0),
	"FISCAL_YEAR_ID" NUMBER,
	"DAYS_IN_CAL_YEAR" NUMBER,
	"DAYS_IN_FIS_YEAR" NUMBER,
	"END_OF_CAL_YEAR" DATE,
	"END_OF_FIS_YEAR" DATE
   ) ;

CREATE TABLE "SH"."SALES_TRANSACTIONS_EXT"
   (	"PROD_ID" NUMBER,
	"CUST_ID" NUMBER,
	"TIME_ID" DATE,
	"CHANNEL_ID" NUMBER,
	"PROMO_ID" NUMBER,
	"QUANTITY_SOLD" NUMBER,
	"AMOUNT_SOLD" NUMBER(10,2),
	"UNIT_COST" NUMBER(10,2),
	"UNIT_PRICE" NUMBER(10,2)
   )
   ORGANIZATION EXTERNAL
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY "DATA_FILE_DIR"
      ACCESS PARAMETERS
      ( RECORDS DELIMITED BY NEWLINE CHARACTERSET US7ASCII
    TERRITORY AMERICA
    BADFILE log_file_dir:'ext_1v3.bad'
    LOGFILE log_file_dir:'ext_1v3.log'
    FIELDS TERMINATED BY "|" OPTIONALLY ENCLOSED BY '^' LDRTRIM
    ( PROD_ID         ,
      CUST_ID         ,
      TIME_ID         DATE(10) "YYYY-MM-DD",
      CHANNEL_ID      ,
      PROMO_ID        ,
      QUANTITY_SOLD   ,
      AMOUNT_SOLD     ,
      UNIT_COST       ,
      UNIT_PRICE
    )
     )
      LOCATION
       ( 'sale1v3.dat'
       )
    )
   REJECT LIMIT 100 ;

CREATE TABLE "SH"."FWEEK_PSCAT_SALES_MV"
   (	"WEEK_ENDING_DAY" DATE,
	"PROD_SUBCATEGORY" VARCHAR2(50),
	"DOLLARS" NUMBER,
	"CHANNEL_ID" NUMBER,
	"PROMO_ID" NUMBER
   ) ;

CREATE TABLE "SH"."CAL_MONTH_SALES_MV"
   (	"CALENDAR_MONTH_DESC" VARCHAR2(8),
	"DOLLARS" NUMBER
   ) ;

GRANT SELECT ON "SH"."COSTS" TO "BI";
GRANT SELECT ON "SH"."CAL_MONTH_SALES_MV" TO "BI";
GRANT SELECT ON "SH"."FWEEK_PSCAT_SALES_MV" TO "BI";
GRANT SELECT ON "SH"."TIMES" TO "BI";
GRANT SELECT ON "SH"."PRODUCTS" TO "BI";
GRANT SELECT ON "SH"."CHANNELS" TO "BI";
GRANT SELECT ON "SH"."PROMOTIONS" TO "BI";
GRANT SELECT ON "SH"."CUSTOMERS" TO "BI";
GRANT SELECT ON "SH"."COUNTRIES" TO "BI";
GRANT SELECT ON "SH"."SALES" TO "BI";
COMMENT ON COLUMN "SH"."SALES"."PROD_ID" IS 'FK to the products dimension table';
COMMENT ON COLUMN "SH"."SALES"."CUST_ID" IS 'FK to the customers dimension table';
COMMENT ON COLUMN "SH"."SALES"."TIME_ID" IS 'FK to the times dimension table';
COMMENT ON COLUMN "SH"."SALES"."CHANNEL_ID" IS 'FK to the channels dimension table';
COMMENT ON COLUMN "SH"."SALES"."PROMO_ID" IS 'promotion identifier, without FK constraint (intentionally) to show outer join optimization';
COMMENT ON COLUMN "SH"."SALES"."QUANTITY_SOLD" IS 'product quantity sold with the transaction';
COMMENT ON COLUMN "SH"."SALES"."AMOUNT_SOLD" IS 'invoiced amount to the customer';
COMMENT ON TABLE "SH"."SALES"  IS 'facts table, without a primary key; all rows are uniquely identified by the combination of all foreign keys';
COMMENT ON COLUMN "SH"."COUNTRIES"."COUNTRY_ID" IS 'primary key';
COMMENT ON COLUMN "SH"."COUNTRIES"."COUNTRY_NAME" IS 'country name';
COMMENT ON COLUMN "SH"."COUNTRIES"."COUNTRY_SUBREGION" IS 'e.g. Western Europe, to allow hierarchies';
COMMENT ON COLUMN "SH"."COUNTRIES"."COUNTRY_REGION" IS 'e.g. Europe, Asia';
COMMENT ON TABLE "SH"."COUNTRIES"  IS 'country dimension table (snowflake)';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_ID" IS 'primary key';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_FIRST_NAME" IS 'first name of the customer';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_LAST_NAME" IS 'last name of the customer';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_GENDER" IS 'gender; low cardinality attribute';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_YEAR_OF_BIRTH" IS 'customer year of birth';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_MARITAL_STATUS" IS 'customer marital status; low cardinality attribute';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_STREET_ADDRESS" IS 'customer street address';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_POSTAL_CODE" IS 'postal code of the customer';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_CITY" IS 'city where the customer lives';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_STATE_PROVINCE" IS 'customer geography: state or province';
COMMENT ON COLUMN "SH"."CUSTOMERS"."COUNTRY_ID" IS 'foreign key to the countries table (snowflake)';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_MAIN_PHONE_NUMBER" IS 'customer main phone number';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_INCOME_LEVEL" IS 'customer income level';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_CREDIT_LIMIT" IS 'customer credit limit';
COMMENT ON COLUMN "SH"."CUSTOMERS"."CUST_EMAIL" IS 'customer email id';
COMMENT ON TABLE "SH"."CUSTOMERS"  IS 'dimension table';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_ID" IS 'primary key column';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_NAME" IS 'promotion description';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_SUBCATEGORY" IS 'enables to investigate promotion hierarchies';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_CATEGORY" IS 'promotion category';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_COST" IS 'promotion cost, to do promotion effect calculations';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_BEGIN_DATE" IS 'promotion begin day';
COMMENT ON COLUMN "SH"."PROMOTIONS"."PROMO_END_DATE" IS 'promotion end day';
COMMENT ON TABLE "SH"."PROMOTIONS"  IS 'dimension table without a PK-FK relationship with the facts table, to show outer join functionality';
COMMENT ON COLUMN "SH"."CHANNELS"."CHANNEL_ID" IS 'primary key column';
COMMENT ON COLUMN "SH"."CHANNELS"."CHANNEL_DESC" IS 'e.g. telesales, internet, catalog';
COMMENT ON COLUMN "SH"."CHANNELS"."CHANNEL_CLASS" IS 'e.g. direct, indirect';
COMMENT ON TABLE "SH"."CHANNELS"  IS 'small dimension table';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_ID" IS 'primary key';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_NAME" IS 'product name';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_DESC" IS 'product description';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_SUBCATEGORY" IS 'product subcategory';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_SUBCATEGORY_DESC" IS 'product subcategory description';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_CATEGORY" IS 'product category';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_CATEGORY_DESC" IS 'product category description';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_WEIGHT_CLASS" IS 'product weight class';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_UNIT_OF_MEASURE" IS 'product unit of measure';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_PACK_SIZE" IS 'product package size';
COMMENT ON COLUMN "SH"."PRODUCTS"."SUPPLIER_ID" IS 'this column';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_STATUS" IS 'product status';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_LIST_PRICE" IS 'product list price';
COMMENT ON COLUMN "SH"."PRODUCTS"."PROD_MIN_PRICE" IS 'product minimum price';
COMMENT ON TABLE "SH"."PRODUCTS"  IS 'dimension table';
COMMENT ON COLUMN "SH"."TIMES"."TIME_ID" IS 'primary key; day date, finest granularity, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."DAY_NAME" IS 'Monday to Sunday, repeating';
COMMENT ON COLUMN "SH"."TIMES"."DAY_NUMBER_IN_WEEK" IS '1 to 7, repeating';
COMMENT ON COLUMN "SH"."TIMES"."DAY_NUMBER_IN_MONTH" IS '1 to 31, repeating';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_WEEK_NUMBER" IS '1 to 53, repeating';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_WEEK_NUMBER" IS '1 to 53, repeating';
COMMENT ON COLUMN "SH"."TIMES"."WEEK_ENDING_DAY" IS 'date of last day in week, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_MONTH_NUMBER" IS '1 to 12, repeating';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_MONTH_NUMBER" IS '1 to 12, repeating';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_MONTH_DESC" IS 'e.g. 1998-01, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_MONTH_DESC" IS 'e.g. 1998-01, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."DAYS_IN_CAL_MONTH" IS 'e.g. 28,31, repeating';
COMMENT ON COLUMN "SH"."TIMES"."DAYS_IN_FIS_MONTH" IS 'e.g. 25,32, repeating';
COMMENT ON COLUMN "SH"."TIMES"."END_OF_CAL_MONTH" IS 'last day of calendar month';
COMMENT ON COLUMN "SH"."TIMES"."END_OF_FIS_MONTH" IS 'last day of fiscal month';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_MONTH_NAME" IS 'January to December, repeating';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_MONTH_NAME" IS 'January to December, repeating';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_QUARTER_DESC" IS 'e.g. 1998-Q1, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_QUARTER_DESC" IS 'e.g. 1999-Q3, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."DAYS_IN_CAL_QUARTER" IS 'e.g. 88,90, repeating';
COMMENT ON COLUMN "SH"."TIMES"."DAYS_IN_FIS_QUARTER" IS 'e.g. 88,90, repeating';
COMMENT ON COLUMN "SH"."TIMES"."END_OF_CAL_QUARTER" IS 'last day of calendar quarter';
COMMENT ON COLUMN "SH"."TIMES"."END_OF_FIS_QUARTER" IS 'last day of fiscal quarter';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_QUARTER_NUMBER" IS '1 to 4, repeating';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_QUARTER_NUMBER" IS '1 to 4, repeating';
COMMENT ON COLUMN "SH"."TIMES"."CALENDAR_YEAR" IS 'e.g. 1999, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."FISCAL_YEAR" IS 'e.g. 1999, CORRECT ORDER';
COMMENT ON COLUMN "SH"."TIMES"."DAYS_IN_CAL_YEAR" IS '365,366 repeating';
COMMENT ON COLUMN "SH"."TIMES"."DAYS_IN_FIS_YEAR" IS 'e.g. 355,364, repeating';
COMMENT ON COLUMN "SH"."TIMES"."END_OF_CAL_YEAR" IS 'last day of cal year';
COMMENT ON COLUMN "SH"."TIMES"."END_OF_FIS_YEAR" IS 'last day of fiscal year';
COMMENT ON TABLE "SH"."TIMES"  IS 'Time dimension table to support multiple hierarchies and materialized views';
CREATE UNIQUE INDEX "SH"."COUNTRIES_PK" ON "SH"."COUNTRIES" ("COUNTRY_ID")
  ;

CREATE UNIQUE INDEX "SH"."CUSTOMERS_PK" ON "SH"."CUSTOMERS" ("CUST_ID")
  ;

CREATE UNIQUE INDEX "SH"."PROMO_PK" ON "SH"."PROMOTIONS" ("PROMO_ID")
  ;

CREATE UNIQUE INDEX "SH"."CHANNELS_PK" ON "SH"."CHANNELS" ("CHANNEL_ID")
  ;

CREATE INDEX "SH"."PRODUCTS_PROD_SUBCAT_IX" ON "SH"."PRODUCTS" ("PROD_SUBCATEGORY")
  ;

CREATE INDEX "SH"."PRODUCTS_PROD_CAT_IX" ON "SH"."PRODUCTS" ("PROD_CATEGORY")
  ;

CREATE UNIQUE INDEX "SH"."PRODUCTS_PK" ON "SH"."PRODUCTS" ("PROD_ID")
  ;

CREATE UNIQUE INDEX "SH"."TIMES_PK" ON "SH"."TIMES" ("TIME_ID")
  ;

ALTER TABLE "SH"."SUPPLEMENTARY_DEMOGRAPHICS" ADD CONSTRAINT "SUPP_DEMO_PK" PRIMARY KEY ("CUST_ID") DISABLE;
ALTER TABLE "SH"."COUNTRIES" ADD CONSTRAINT "COUNTRIES_PK" PRIMARY KEY ("COUNTRY_ID")
  USING INDEX  ENABLE NOVALIDATE;

ALTER TABLE "SH"."CUSTOMERS" ADD CONSTRAINT "CUSTOMERS_PK" PRIMARY KEY ("CUST_ID")
  USING INDEX  ENABLE NOVALIDATE;

ALTER TABLE "SH"."PROMOTIONS" ADD CONSTRAINT "PROMO_PK" PRIMARY KEY ("PROMO_ID")
  USING INDEX  ENABLE NOVALIDATE;

ALTER TABLE "SH"."CHANNELS" ADD CONSTRAINT "CHANNELS_PK" PRIMARY KEY ("CHANNEL_ID")
  USING INDEX  ENABLE NOVALIDATE;

ALTER TABLE "SH"."PRODUCTS" ADD CONSTRAINT "PRODUCTS_PK" PRIMARY KEY ("PROD_ID")
  USING INDEX  ENABLE NOVALIDATE;

ALTER TABLE "SH"."TIMES" ADD CONSTRAINT "TIMES_PK" PRIMARY KEY ("TIME_ID")
  USING INDEX  ENABLE NOVALIDATE;

-- [dbsrc POST-PROCESSED]:
-- (17) Handle sqlplus limitation by injecting newlines after commas in
--      view column specs (SP2-0027: Input is too long (> 2499 characters)
--      - line ignored).
CREATE OR REPLACE FORCE EDITIONABLE VIEW "SH"."PROFITS" ("CHANNEL_ID",
"CUST_ID",
"PROD_ID",
"PROMO_ID",
"TIME_ID",
"UNIT_COST",
"UNIT_PRICE",
"AMOUNT_SOLD",
"QUANTITY_SOLD",
"TOTAL_COST") AS
  SELECT
        s.channel_id,
        s.cust_id,
        s.prod_id,
        s.promo_id,
        s.time_id,
        c.unit_cost,
        c.unit_price,
        s.amount_sold,
        s.quantity_sold,
        c.unit_cost * s.quantity_sold TOTAL_COST
 FROM   costs c, sales s
 WHERE c.prod_id = s.prod_id
   AND c.time_id = s.time_id
   AND c.channel_id = s.channel_id
   AND c.promo_id = s.promo_id;

ALTER TABLE "SH"."COSTS" ADD CONSTRAINT "COSTS_PROMO_FK" FOREIGN KEY ("PROMO_ID")
	  REFERENCES "SH"."PROMOTIONS" ("PROMO_ID") DISABLE;

ALTER TABLE "SH"."COSTS" ADD CONSTRAINT "COSTS_PRODUCT_FK" FOREIGN KEY ("PROD_ID")
	  REFERENCES "SH"."PRODUCTS" ("PROD_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."COSTS" ADD CONSTRAINT "COSTS_TIME_FK" FOREIGN KEY ("TIME_ID")
	  REFERENCES "SH"."TIMES" ("TIME_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."COSTS" ADD CONSTRAINT "COSTS_CHANNEL_FK" FOREIGN KEY ("CHANNEL_ID")
	  REFERENCES "SH"."CHANNELS" ("CHANNEL_ID") DISABLE;

ALTER TABLE "SH"."SALES" ADD CONSTRAINT "SALES_PROMO_FK" FOREIGN KEY ("PROMO_ID")
	  REFERENCES "SH"."PROMOTIONS" ("PROMO_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."SALES" ADD CONSTRAINT "SALES_CUSTOMER_FK" FOREIGN KEY ("CUST_ID")
	  REFERENCES "SH"."CUSTOMERS" ("CUST_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."SALES" ADD CONSTRAINT "SALES_PRODUCT_FK" FOREIGN KEY ("PROD_ID")
	  REFERENCES "SH"."PRODUCTS" ("PROD_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."SALES" ADD CONSTRAINT "SALES_TIME_FK" FOREIGN KEY ("TIME_ID")
	  REFERENCES "SH"."TIMES" ("TIME_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."SALES" ADD CONSTRAINT "SALES_CHANNEL_FK" FOREIGN KEY ("CHANNEL_ID")
	  REFERENCES "SH"."CHANNELS" ("CHANNEL_ID") ENABLE NOVALIDATE;

ALTER TABLE "SH"."CUSTOMERS" ADD CONSTRAINT "CUSTOMERS_COUNTRY_FK" FOREIGN KEY ("COUNTRY_ID")
	  REFERENCES "SH"."COUNTRIES" ("COUNTRY_ID") ENABLE NOVALIDATE;

CREATE BITMAP INDEX "SH"."COSTS_TIME_BIX" ON "SH"."COSTS" ("TIME_ID")
  ;

CREATE BITMAP INDEX "SH"."COSTS_PROD_BIX" ON "SH"."COSTS" ("PROD_ID")
  ;

CREATE BITMAP INDEX "SH"."SALES_CUST_BIX" ON "SH"."SALES" ("CUST_ID")
  ;

CREATE BITMAP INDEX "SH"."SALES_CHANNEL_BIX" ON "SH"."SALES" ("CHANNEL_ID")
  ;

CREATE BITMAP INDEX "SH"."SALES_TIME_BIX" ON "SH"."SALES" ("TIME_ID")
  ;

CREATE BITMAP INDEX "SH"."SALES_PROMO_BIX" ON "SH"."SALES" ("PROMO_ID")
  ;

CREATE BITMAP INDEX "SH"."SALES_PROD_BIX" ON "SH"."SALES" ("PROD_ID")
  ;

CREATE BITMAP INDEX "SH"."CUSTOMERS_MARITAL_BIX" ON "SH"."CUSTOMERS" ("CUST_MARITAL_STATUS")
  ;

CREATE BITMAP INDEX "SH"."CUSTOMERS_YOB_BIX" ON "SH"."CUSTOMERS" ("CUST_YEAR_OF_BIRTH")
  ;

CREATE BITMAP INDEX "SH"."CUSTOMERS_GENDER_BIX" ON "SH"."CUSTOMERS" ("CUST_GENDER")
  ;

CREATE BITMAP INDEX "SH"."PRODUCTS_PROD_STATUS_BIX" ON "SH"."PRODUCTS" ("PROD_STATUS")
  ;

CREATE BITMAP INDEX "SH"."FW_PSC_S_MV_SUBCAT_BIX" ON "SH"."FWEEK_PSCAT_SALES_MV" ("PROD_SUBCATEGORY")
  ;

CREATE BITMAP INDEX "SH"."FW_PSC_S_MV_CHAN_BIX" ON "SH"."FWEEK_PSCAT_SALES_MV" ("CHANNEL_ID")
  ;

CREATE BITMAP INDEX "SH"."FW_PSC_S_MV_PROMO_BIX" ON "SH"."FWEEK_PSCAT_SALES_MV" ("PROMO_ID")
  ;

CREATE BITMAP INDEX "SH"."FW_PSC_S_MV_WD_BIX" ON "SH"."FWEEK_PSCAT_SALES_MV" ("WEEK_ENDING_DAY")
  ;

CREATE INDEX "SH"."SUP_TEXT_IDX" ON "SH"."SUPPLEMENTARY_DEMOGRAPHICS" ("COMMENTS")
   INDEXTYPE IS "CTXSYS"."CONTEXT"  PARAMETERS ('nopopulate');

CREATE MATERIALIZED VIEW "SH"."CAL_MONTH_SALES_MV" ("CALENDAR_MONTH_DESC", "DOLLARS")
  ON PREBUILT TABLE WITHOUT REDUCED PRECISION
  USING INDEX
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS ENABLE QUERY REWRITE
  AS SELECT   t.calendar_month_desc
  ,        sum(s.amount_sold) AS dollars
  FROM     sales s
  ,        times t
  WHERE    s.time_id = t.time_id
  GROUP BY t.calendar_month_desc;

CREATE MATERIALIZED VIEW "SH"."FWEEK_PSCAT_SALES_MV" ("WEEK_ENDING_DAY", "PROD_SUBCATEGORY", "DOLLARS", "CHANNEL_ID", "PROMO_ID")
  ON PREBUILT TABLE WITHOUT REDUCED PRECISION
  USING INDEX
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS ENABLE QUERY REWRITE
  AS SELECT   t.week_ending_day
  ,        p.prod_subcategory
  ,        sum(s.amount_sold) AS dollars
  ,        s.channel_id
  ,        s.promo_id
  FROM     sales s
  ,        times t
  ,        products p
  WHERE    s.time_id = t.time_id
  AND      s.prod_id = p.prod_id
  GROUP BY t.week_ending_day
  ,        p.prod_subcategory
  ,        s.channel_id
  ,        s.promo_id;

CREATE DIMENSION "SH"."CUSTOMERS_DIM" LEVEL "CUSTOMER" IS ("CUSTOMERS"."CUST_ID") LEVEL "CITY" IS ("CUSTOMERS"."CUST_CITY_ID") LEVEL "STATE" IS ("CUSTOMERS"."CUST_STATE_PROVINCE_ID") LEVEL "COUNTRY" IS ("COUNTRIES"."COUNTRY_ID") LEVEL "SUBREGION" IS ("COUNTRIES"."COUNTRY_SUBREGION_ID") LEVEL "REGION" IS ("COUNTRIES"."COUNTRY_REGION_ID") LEVEL "GEOG_TOTAL" IS ("COUNTRIES"."COUNTRY_TOTAL_ID") LEVEL "CUST_TOTAL" IS ("CUSTOMERS"."CUST_TOTAL_ID") HIERARCHY "CUST_ROLLUP" ("CUSTOMER" CHILD OF "CITY" CHILD OF "STATE" CHILD OF "CUST_TOTAL") HIERARCHY "GEOG_ROLLUP" ("CUSTOMER" CHILD OF "CITY" CHILD OF "STATE" CHILD OF "COUNTRY" CHILD OF "SUBREGION" CHILD OF "REGION" CHILD OF "GEOG_TOTAL" JOIN KEY ("CUSTOMERS"."COUNTRY_ID") REFERENCES "COUNTRY") ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_FIRST_NAME" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_EMAIL" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_MAIN_PHONE_NUMBER" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_POSTAL_CODE" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_STREET_ADDRESS" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_CREDIT_LIMIT" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_INCOME_LEVEL" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_YEAR_OF_BIRTH" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_MARITAL_STATUS" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_GENDER" ATTRIBUTE "CUSTOMER" LEVEL "CUSTOMER" DETERMINES "CUSTOMERS"."CUST_LAST_NAME" ATTRIBUTE "CITY" LEVEL "CITY" DETERMINES "CUSTOMERS"."CUST_CITY" ATTRIBUTE "STATE" LEVEL "STATE" DETERMINES "CUSTOMERS"."CUST_STATE_PROVINCE" ATTRIBUTE "COUNTRY" LEVEL "COUNTRY" DETERMINES "COUNTRIES"."COUNTRY_NAME" ATTRIBUTE "COUNTRY" LEVEL "COUNTRY" DETERMINES "COUNTRIES"."COUNTRY_ISO_CODE" ATTRIBUTE "SUBREGION" LEVEL "SUBREGION" DETERMINES "COUNTRIES"."COUNTRY_SUBREGION" ATTRIBUTE "REGION" LEVEL "REGION" DETERMINES "COUNTRIES"."COUNTRY_REGION" ATTRIBUTE "GEOG_TOTAL" LEVEL "GEOG_TOTAL" DETERMINES "COUNTRIES"."COUNTRY_TOTAL" ATTRIBUTE "CUST_TOTAL" LEVEL "CUST_TOTAL" DETERMINES "CUSTOMERS"."CUST_TOTAL";
CREATE DIMENSION "SH"."PRODUCTS_DIM" LEVEL "PRODUCT" IS ("PRODUCTS"."PROD_ID") LEVEL "SUBCATEGORY" IS ("PRODUCTS"."PROD_SUBCATEGORY_ID") LEVEL "CATEGORY" IS ("PRODUCTS"."PROD_CATEGORY_ID") LEVEL "PROD_TOTAL" IS ("PRODUCTS"."PROD_TOTAL_ID") HIERARCHY "PROD_ROLLUP" ("PRODUCT" CHILD OF "SUBCATEGORY" CHILD OF "CATEGORY" CHILD OF "PROD_TOTAL") ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_NAME" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_MIN_PRICE" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_LIST_PRICE" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_STATUS" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_PACK_SIZE" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_UNIT_OF_MEASURE" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_WEIGHT_CLASS" ATTRIBUTE "PRODUCT" LEVEL "PRODUCT" DETERMINES "PRODUCTS"."PROD_DESC" ATTRIBUTE "SUBCATEGORY" LEVEL "SUBCATEGORY" DETERMINES "PRODUCTS"."PROD_SUBCATEGORY" ATTRIBUTE "SUBCATEGORY" LEVEL "SUBCATEGORY" DETERMINES "PRODUCTS"."PROD_SUBCATEGORY_DESC" ATTRIBUTE "CATEGORY" LEVEL "CATEGORY" DETERMINES "PRODUCTS"."PROD_CATEGORY" ATTRIBUTE "CATEGORY" LEVEL "CATEGORY" DETERMINES "PRODUCTS"."PROD_CATEGORY_DESC" ATTRIBUTE "PROD_TOTAL" LEVEL "PROD_TOTAL" DETERMINES "PRODUCTS"."PROD_TOTAL";
CREATE DIMENSION "SH"."TIMES_DIM" LEVEL "DAY" IS ("TIMES"."TIME_ID") LEVEL "MONTH" IS ("TIMES"."CALENDAR_MONTH_ID") LEVEL "QUARTER" IS ("TIMES"."CALENDAR_QUARTER_ID") LEVEL "YEAR" IS ("TIMES"."CALENDAR_YEAR_ID") LEVEL "FIS_WEEK" IS ("TIMES"."WEEK_ENDING_DAY_ID") LEVEL "FIS_MONTH" IS ("TIMES"."FISCAL_MONTH_ID") LEVEL "FIS_QUARTER" IS ("TIMES"."FISCAL_QUARTER_ID") LEVEL "FIS_YEAR" IS ("TIMES"."FISCAL_YEAR_ID") HIERARCHY "CAL_ROLLUP" ("DAY" CHILD OF "MONTH" CHILD OF "QUARTER" CHILD OF "YEAR") HIERARCHY "FIS_ROLLUP" ("DAY" CHILD OF "FIS_WEEK" CHILD OF "FIS_MONTH" CHILD OF "FIS_QUARTER" CHILD OF "FIS_YEAR") ATTRIBUTE "DAY" LEVEL "DAY" DETERMINES "TIMES"."DAY_NUMBER_IN_WEEK" ATTRIBUTE "DAY" LEVEL "DAY" DETERMINES "TIMES"."CALENDAR_WEEK_NUMBER" ATTRIBUTE "DAY" LEVEL "DAY" DETERMINES "TIMES"."DAY_NUMBER_IN_MONTH" ATTRIBUTE "DAY" LEVEL "DAY" DETERMINES "TIMES"."DAY_NAME" ATTRIBUTE "MONTH" LEVEL "MONTH" DETERMINES "TIMES"."CALENDAR_MONTH_DESC" ATTRIBUTE "MONTH" LEVEL "MONTH" DETERMINES "TIMES"."END_OF_CAL_MONTH" ATTRIBUTE "MONTH" LEVEL "MONTH" DETERMINES "TIMES"."DAYS_IN_CAL_MONTH" ATTRIBUTE "MONTH" LEVEL "MONTH" DETERMINES "TIMES"."CALENDAR_MONTH_NAME" ATTRIBUTE "MONTH" LEVEL "MONTH" DETERMINES "TIMES"."CALENDAR_MONTH_NUMBER" ATTRIBUTE "QUARTER" LEVEL "QUARTER" DETERMINES "TIMES"."CALENDAR_QUARTER_DESC" ATTRIBUTE "QUARTER" LEVEL "QUARTER" DETERMINES "TIMES"."END_OF_CAL_QUARTER" ATTRIBUTE "QUARTER" LEVEL "QUARTER" DETERMINES "TIMES"."DAYS_IN_CAL_QUARTER" ATTRIBUTE "QUARTER" LEVEL "QUARTER" DETERMINES "TIMES"."CALENDAR_QUARTER_NUMBER" ATTRIBUTE "YEAR" LEVEL "YEAR" DETERMINES "TIMES"."CALENDAR_YEAR" ATTRIBUTE "YEAR" LEVEL "YEAR" DETERMINES "TIMES"."END_OF_CAL_YEAR" ATTRIBUTE "YEAR" LEVEL "YEAR" DETERMINES "TIMES"."DAYS_IN_CAL_YEAR" ATTRIBUTE "FIS_WEEK" LEVEL "FIS_WEEK" DETERMINES "TIMES"."WEEK_ENDING_DAY" ATTRIBUTE "FIS_WEEK" LEVEL "FIS_WEEK" DETERMINES "TIMES"."FISCAL_WEEK_NUMBER" ATTRIBUTE "FIS_MONTH" LEVEL "FIS_MONTH" DETERMINES "TIMES"."FISCAL_MONTH_DESC" ATTRIBUTE "FIS_MONTH" LEVEL "FIS_MONTH" DETERMINES "TIMES"."END_OF_FIS_MONTH" ATTRIBUTE "FIS_MONTH" LEVEL "FIS_MONTH" DETERMINES "TIMES"."DAYS_IN_FIS_MONTH" ATTRIBUTE "FIS_MONTH" LEVEL "FIS_MONTH" DETERMINES "TIMES"."FISCAL_MONTH_NAME" ATTRIBUTE "FIS_MONTH" LEVEL "FIS_MONTH" DETERMINES "TIMES"."FISCAL_MONTH_NUMBER" ATTRIBUTE "FIS_QUARTER" LEVEL "FIS_QUARTER" DETERMINES "TIMES"."FISCAL_QUARTER_DESC" ATTRIBUTE "FIS_QUARTER" LEVEL "FIS_QUARTER" DETERMINES "TIMES"."END_OF_FIS_QUARTER" ATTRIBUTE "FIS_QUARTER" LEVEL "FIS_QUARTER" DETERMINES "TIMES"."DAYS_IN_FIS_QUARTER" ATTRIBUTE "FIS_QUARTER" LEVEL "FIS_QUARTER" DETERMINES "TIMES"."FISCAL_QUARTER_NUMBER" ATTRIBUTE "FIS_YEAR" LEVEL "FIS_YEAR" DETERMINES "TIMES"."FISCAL_YEAR" ATTRIBUTE "FIS_YEAR" LEVEL "FIS_YEAR" DETERMINES "TIMES"."END_OF_FIS_YEAR" ATTRIBUTE "FIS_YEAR" LEVEL "FIS_YEAR" DETERMINES "TIMES"."DAYS_IN_FIS_YEAR";
CREATE DIMENSION "SH"."CHANNELS_DIM" LEVEL "CHANNEL" IS ("CHANNELS"."CHANNEL_ID") LEVEL "CHANNEL_CLASS" IS ("CHANNELS"."CHANNEL_CLASS_ID") LEVEL "CHANNEL_TOTAL" IS ("CHANNELS"."CHANNEL_TOTAL_ID") HIERARCHY "CHANNEL_ROLLUP" ("CHANNEL" CHILD OF "CHANNEL_CLASS" CHILD OF "CHANNEL_TOTAL") ATTRIBUTE "CHANNEL" LEVEL "CHANNEL" DETERMINES "CHANNELS"."CHANNEL_DESC" ATTRIBUTE "CHANNEL_CLASS" LEVEL "CHANNEL_CLASS" DETERMINES "CHANNELS"."CHANNEL_CLASS" ATTRIBUTE "CHANNEL_TOTAL" LEVEL "CHANNEL_TOTAL" DETERMINES "CHANNELS"."CHANNEL_TOTAL";
CREATE DIMENSION "SH"."PROMOTIONS_DIM" LEVEL "PROMO" IS ("PROMOTIONS"."PROMO_ID") LEVEL "SUBCATEGORY" IS ("PROMOTIONS"."PROMO_SUBCATEGORY_ID") LEVEL "CATEGORY" IS ("PROMOTIONS"."PROMO_CATEGORY_ID") LEVEL "PROMO_TOTAL" IS ("PROMOTIONS"."PROMO_TOTAL_ID") HIERARCHY "PROMO_ROLLUP" ("PROMO" CHILD OF "SUBCATEGORY" CHILD OF "CATEGORY" CHILD OF "PROMO_TOTAL") ATTRIBUTE "PROMO" LEVEL "PROMO" DETERMINES "PROMOTIONS"."PROMO_NAME" ATTRIBUTE "PROMO" LEVEL "PROMO" DETERMINES "PROMOTIONS"."PROMO_END_DATE" ATTRIBUTE "PROMO" LEVEL "PROMO" DETERMINES "PROMOTIONS"."PROMO_BEGIN_DATE" ATTRIBUTE "PROMO" LEVEL "PROMO" DETERMINES "PROMOTIONS"."PROMO_COST" ATTRIBUTE "SUBCATEGORY" LEVEL "SUBCATEGORY" DETERMINES "PROMOTIONS"."PROMO_SUBCATEGORY" ATTRIBUTE "CATEGORY" LEVEL "CATEGORY" DETERMINES "PROMOTIONS"."PROMO_CATEGORY" ATTRIBUTE "PROMO_TOTAL" LEVEL "PROMO_TOTAL" DETERMINES "PROMOTIONS"."PROMO_TOTAL";
